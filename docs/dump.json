[
  {
    "kind": "file",
    "static": true,
    "variation": null,
    "name": "lib/deployer.js",
    "memberof": null,
    "longname": "lib/deployer.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport streamToPromise from 'stream-to-promise';\nimport Targz from 'tar.gz';\nimport config from 'config';\nimport path from 'path';\nimport moment from 'moment';\nimport Bluebird from 'bluebird';\nimport {\n  _mongoose, Organisation, Application, ExecutionLogEvent\n}\nfrom '@hoist/model';\nimport {\n  ApplicationEventLogger,\n  NotificationLogger,\n  Notification\n}\nfrom '@hoist/broker';\nimport errors from '@hoist/errors';\nimport jsonlint from 'jsonlint';\nimport Git from 'nodegit';\nimport Agenda from 'agenda';\nimport _ from 'lodash';\n\nlet fs = Bluebird.promisifyAll(require('fs-extra'));\nlet temp = Bluebird.promisifyAll(require('temp'));\nlet targz = Bluebird.promisifyAll(new Targz());\nlet gitArchive = Bluebird.promisify(require('git-archive'));\nBluebird.promisifyAll(_mongoose);\n\n\nclass Deployer {\n  constructor(buffer) {\n    temp.track();\n    let params = buffer.toString().replace('\\n', '').split(' ');\n    this.timestamp = moment();\n    this.originalSha1 = params[0];\n    this.commitSha1 = params[1];\n    this.branch = params[2];\n    this.applicationEventLogger = new ApplicationEventLogger();\n    this.notificationLogger = new NotificationLogger();\n    let subpath = process.cwd().replace(config.get('Hoist.filePaths.repositories'), '');\n    subpath = subpath.replace('.git', '');\n\n    let subPathParts = subpath.split('/');\n\n    this.organisationSlug = subPathParts[1];\n    this.applicationSlug = subPathParts[2];\n    this.deployRoot = path.join(config.get(\"Hoist.filePaths.deploys\"), subpath);\n    this.deployFolder = this.timestamp.format('X');\n  }\n  getNpmCachePath() {\n    return this.npmCachePath || (this.npmCachePath = path.join(this.deployRoot, '.npmcache'));\n  }\n  getDeployPath() {\n    return this.deployPath || (this.deployPath = path.join(this.deployRoot, this.deployFolder));\n  }\n  getSymlinkPathPath() {\n    return this.symlinkPath || (this.symlinkPath = path.join(this.deployRoot, 'current'));\n  }\n  primeRepository() {\n    return Git.Repository.open(process.cwd())\n      .then((repository) => {\n        this.repository = repository;\n      });\n  }\n  getAgenda() {\n    return this.agenda || (this.agenda = Bluebird.promisifyAll(new Agenda({\n      db: {\n        address: config.get('Hoist.mongo.core.connectionString')\n      }\n    })));\n  }\n  deploy() {\n    let deleteDeployDir = true;\n    if (this.commitSha1 === \"0000000000000000000000000000000000000000\") {\n      //deleting branch\n      return Promise.resolve();\n    }\n    return this.printBanner()\n      .then(() => {\n\n        return this.openDBConnection();\n      })\n      .then(() => {\n        return this.primeRepository();\n      })\n      .then(() => {\n        return this.loadApplication();\n      })\n      .then(() => {\n        return this.applicationEventLogger.log(new ExecutionLogEvent({\n          message: `Deploy starting. Hash: ${this.commitSha1}`,\n          type: 'DEPLOY',\n          application: this.application._id,\n          environment: 'live'\n        }));\n      }).then(() => {\n        return this.createArchive();\n      }).then(() => {\n        return this.deployArchive();\n      }).then(() => {\n        return this.npmInstall();\n      }).then(() => {\n\n        console.log('updating config');\n        return this.updateConfig();\n      }).then(() => {\n        return this.updateSchedules();\n      }).then(() => {\n        return this.application.saveAsync();\n      }).then(() => {\n        return this.linkReleaseDirectory();\n      }).then(() => {\n        deleteDeployDir = false;\n        process.stdout.write('\\x1b[32mDeploy Completed Successfully\\x1b[37m\\n');\n      }).then(() => {\n        return this.clearOldDirectories().catch(() => {});\n      }).then(() => {\n        return this.notificationLogger.log(new Notification({\n          applicationId: this.application._id,\n          notificationType: 'Update'\n        }));\n      }).then(() => {\n        if (this.application) {\n          return this.applicationEventLogger.log(new ExecutionLogEvent({\n            message: `Deploy complete. Hash: ${this.commitSha1}`,\n            type: 'DEPLOY',\n            application: this.application._id,\n            environment: 'live'\n          }));\n        }\n      }).catch((err) => {\n        console.error(err);\n        return Promise.resolve()\n          .then(() => {\n            if (this.application) {\n              return this.applicationEventLogger.log(new ExecutionLogEvent({\n                message: `Deploy failed. Hash: ${this.commitSha1}`,\n                type: 'DEPLOY',\n                application: this.application._id,\n                environment: 'live'\n              }));\n            }\n          }).then(() => {\n            if (deleteDeployDir) {\n              return fs.removeAsync(this.getDeployPath())\n                .catch((err2) => {\n                  console.error(err2);\n                });\n            }\n          }).then(() => {\n            throw err;\n          });\n      }).finally(() => {\n        return this.closeDBConnection();\n      });\n  }\n  openDBConnection() {\n    return _mongoose.connectAsync(config.get('Hoist.mongo.core.connectionString'));\n  }\n  closeDBConnection() {\n    return _mongoose.disconnectAsync();\n  }\n  loadOrganisation() {\n    return Bluebird.resolve(this.organisation || Organisation.findOneAsync({\n      slug: this.organisationSlug\n    })).then((organisation) => {\n      this.organisation = organisation;\n      return this.organisation;\n    });\n  }\n  loadApplication() {\n    return Bluebird.resolve(this.application || this.loadOrganisation()\n      .then(() => {\n        return Application.findOneAsync({\n          organisation: this.organisation._id,\n          slug: this.applicationSlug\n        });\n      }).then((application) => {\n        this.application = application;\n      }));\n  }\n  updateConfig() {\n    return this.loadHoistJSON()\n      .then((hoistJson) => {\n        console.log('saving new settings');\n        this.application.settings.live = hoistJson;\n        this.application.markModified('settings.live');\n        this.application.lastDeploy.live = this.timestamp.toDate();\n        return this.repository.getCommit(this.commitSha1)\n          .then((commit) => {\n            this.application.lastCommit.live = {\n              message: commit.message(),\n              sha1: this.commitSha1,\n              user: commit.author().name() + ' ' + commit.author().email()\n            };\n\n          });\n\n\n      });\n  }\n  loadHoistJSON() {\n    return fs.readFileAsync(path.join(this.getDeployPath(), 'hoist.json'), {\n        encoding: 'utf8'\n      })\n      .then((hoistJson) => {\n        return Bluebird.try(() => {\n          console.log('parsing hoist.json file');\n          return jsonlint.parse(hoistJson);\n        }).catch(function (err) {\n\n          throw new errors.files.hoistJson.InvalidJsonError(err.message);\n        });\n      });\n  }\n  restoreNpmCache() {\n    return Bluebird.try(() => {\n      if (fs.existsSync(this.getNpmCachePath())) {\n        var progress = setInterval(function () {\n          process.stdout.write('#');\n        }, 10);\n        console.log('restoring npm cache');\n        return fs.copyAsync(this.getNpmCachePath(), path.join(this.getDeployPath(), 'node_modules')).finally(function () {\n          clearInterval(progress);\n          console.log('#\\n');\n        });\n      }\n    });\n  }\n  saveNpmCache() {\n    return Bluebird.try(() => {\n        console.log('saving npm cache');\n        if (fs.existsSync(this.getNpmCachePath())) {\n          return fs.removeAsync(this.getNpmCachePath());\n        }\n      })\n      .then(() => {\n        this.progress = setInterval(function () {\n          process.stdout.write('#');\n        }, 10);\n      })\n      .then(() => {\n        return fs.copyAsync(path.join(this.getDeployPath(), 'node_modules'), this.getNpmCachePath(), {\n            clobber: true\n          })\n          .finally(() => {\n            clearInterval(this.progress);\n            process.stdout.write('#\\n');\n          });\n      });\n  }\n  npmInstall() {\n    var packageJsonPath = path.join(this.getDeployPath(), 'package.json');\n    //no package.json so don't do an npm install\n    if (!fs.existsSync(packageJsonPath)) {\n      return Bluebird.resolve(null);\n    }\n    return this.restoreNpmCache()\n      .then(() => {\n        console.log('\\x1b[32m--------> starting npm install\\x1b[37m\\n');\n        return new Bluebird((resolve, reject) => {\n          var npmProcess = require('child_process')\n            .spawn('npm', ['install', '--production', '--loglevel info', '--spin false'], {\n              cwd: this.getDeployPath(),\n              stdio: [process.stdin, process.stdout, 'pipe']\n            });\n          npmProcess.stderr.on('data', function (data) {\n            process.stdout.write('\\x1b[31m');\n            process.stdout.write(data);\n            process.stdout.write('\\x1b[37m');\n          });\n          npmProcess.on('exit', function (code) {\n            if (code === 0) {\n              process.stdout.write('\\x1b[32m<-------- npm install done\\x1b[37m\\n');\n              resolve();\n            } else {\n              reject(new Error('npm install failed'));\n            }\n          });\n        });\n      }).then(() => {\n        return this.saveNpmCache();\n      });\n\n\n  }\n  printBanner() {\n    return streamToPromise(fs.createReadStream(path.resolve(__dirname, './banner.txt')))\n      .then((banner) => {\n        process.stdout.write('\\x1b[32m');\n        process.stdout.write(banner);\n        process.stdout.write('\\x1b[37m');\n      })\n      .then(() => {\n        console.log('starting deployment');\n        console.log('\\x1b[42;30mref:\\x1b[40;37m', this.branch);\n        console.log('\\x1b[42;30mcommit:\\x1b[40;37m', this.commitSha1);\n        console.log('\\x1b[42;30moriginal:\\x1b[40;37m', this.originalSha1);\n      });\n  }\n  createArchive() {\n    return temp.openAsync({\n      suffix: '.tar.gz'\n    }).then((archive) => {\n      this.archive = archive;\n\n      return gitArchive({\n        commit: this.commitSha1,\n        outputPath: archive.path,\n        repoPath: process.cwd()\n      });\n    });\n  }\n  deployArchive() {\n    return targz.extractAsync(this.archive.path, this.getDeployPath());\n  }\n  updateSchedules() {\n    console.log('deleting existing schedules');\n    return this.getAgenda().cancelAsync({\n      'data.application': this.application._id\n    }).then(() => {\n      if (this.application.settings.live.schedules) {\n        return Bluebird.all(_.map(this.application.settings.live.schedules, (schedule, key) => {\n          var scheduleJob = Bluebird.promisifyAll(this.agenda.create('create:event2', {\n            application: this.application._id,\n            environment: 'live',\n            events: schedule.events\n          }));\n          scheduleJob.repeatEvery(key);\n          scheduleJob.computeNextRunAt();\n          console.log('adding schedule for ' + key);\n          return scheduleJob.saveAsync();\n        }, this));\n      }\n    });\n  }\n  clearOldDirectories() {\n    console.log('cleaning up');\n    return fs.readdirAsync(this.deployRoot)\n      .then((directories) => {\n        directories = _.sortBy(_.without(directories, '.npmcache'), function (dirName) {\n          return dirName;\n        });\n\n        //keep 3 directories\n        var directoriesToDelete = _.dropRight(directories, 3);\n\n        return Bluebird.all(_.map(directoriesToDelete, (dir) => {\n          return fs.removeAsync(path.join(this.deployRoot, dir));\n        }));\n      });\n  }\n  linkReleaseDirectory() {\n    console.log('marking release as current');\n    return Promise.resolve()\n      .then(() => {\n        if (fs.existsSync(this.getSymlinkPathPath())) {\n          return fs.unlinkAsync(this.getSymlinkPathPath());\n        }\n      })\n      .then(() => {\n        return fs.symlinkAsync(this.getDeployPath(), this.getSymlinkPathPath());\n      });\n  }\n\n}\n\nmodule.exports = Deployer;\n"
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "fs",
    "memberof": "lib/deployer.js",
    "longname": "lib/deployer.js~fs",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/deployer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 24,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "temp",
    "memberof": "lib/deployer.js",
    "longname": "lib/deployer.js~temp",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/deployer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "targz",
    "memberof": "lib/deployer.js",
    "longname": "lib/deployer.js~targz",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/deployer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 26,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "gitArchive",
    "memberof": "lib/deployer.js",
    "longname": "lib/deployer.js~gitArchive",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/deployer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "class",
    "static": true,
    "variation": null,
    "name": "Deployer",
    "memberof": "lib/deployer.js",
    "longname": "lib/deployer.js~Deployer",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/deployer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "interface": false
  },
  {
    "kind": "constructor",
    "static": false,
    "variation": null,
    "name": "constructor",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#constructor",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "params": [
      {
        "name": "buffer",
        "types": [
          "*"
        ]
      }
    ],
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "timestamp",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#timestamp",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "originalSha1",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#originalSha1",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "commitSha1",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#commitSha1",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "branch",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#branch",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "applicationEventLogger",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#applicationEventLogger",
    "access": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "notificationLogger",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#notificationLogger",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "organisationSlug",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#organisationSlug",
    "access": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "applicationSlug",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#applicationSlug",
    "access": null,
    "description": null,
    "lineNumber": 47,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "deployRoot",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#deployRoot",
    "access": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "deployFolder",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#deployFolder",
    "access": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "getNpmCachePath",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#getNpmCachePath",
    "access": null,
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "getDeployPath",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#getDeployPath",
    "access": null,
    "description": null,
    "lineNumber": 54,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "getSymlinkPathPath",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#getSymlinkPathPath",
    "access": null,
    "description": null,
    "lineNumber": 57,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "primeRepository",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#primeRepository",
    "access": null,
    "description": null,
    "lineNumber": 60,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "repository",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#repository",
    "access": null,
    "description": null,
    "lineNumber": 63,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "getAgenda",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#getAgenda",
    "access": null,
    "description": null,
    "lineNumber": 66,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "deploy",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#deploy",
    "access": null,
    "description": null,
    "lineNumber": 73,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "openDBConnection",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#openDBConnection",
    "access": null,
    "description": null,
    "lineNumber": 158,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "closeDBConnection",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#closeDBConnection",
    "access": null,
    "description": null,
    "lineNumber": 161,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "loadOrganisation",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#loadOrganisation",
    "access": null,
    "description": null,
    "lineNumber": 164,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "organisation",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#organisation",
    "access": null,
    "description": null,
    "lineNumber": 168,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "loadApplication",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#loadApplication",
    "access": null,
    "description": null,
    "lineNumber": 172,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "application",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#application",
    "access": null,
    "description": null,
    "lineNumber": 180,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "updateConfig",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#updateConfig",
    "access": null,
    "description": null,
    "lineNumber": 183,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "loadHoistJSON",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#loadHoistJSON",
    "access": null,
    "description": null,
    "lineNumber": 203,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "restoreNpmCache",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#restoreNpmCache",
    "access": null,
    "description": null,
    "lineNumber": 217,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "saveNpmCache",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#saveNpmCache",
    "access": null,
    "description": null,
    "lineNumber": 231,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "progress",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#progress",
    "access": null,
    "description": null,
    "lineNumber": 239,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "npmInstall",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#npmInstall",
    "access": null,
    "description": null,
    "lineNumber": 253,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "printBanner",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#printBanner",
    "access": null,
    "description": null,
    "lineNumber": 288,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "createArchive",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#createArchive",
    "access": null,
    "description": null,
    "lineNumber": 302,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "archive",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#archive",
    "access": null,
    "description": null,
    "lineNumber": 306,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "deployArchive",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#deployArchive",
    "access": null,
    "description": null,
    "lineNumber": 315,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "updateSchedules",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#updateSchedules",
    "access": null,
    "description": null,
    "lineNumber": 318,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "clearOldDirectories",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#clearOldDirectories",
    "access": null,
    "description": null,
    "lineNumber": 338,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "linkReleaseDirectory",
    "memberof": "lib/deployer.js~Deployer",
    "longname": "lib/deployer.js~Deployer#linkReleaseDirectory",
    "access": null,
    "description": null,
    "lineNumber": 354,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "file",
    "static": true,
    "variation": null,
    "name": "lib/git_action_listener.js",
    "memberof": null,
    "longname": "lib/git_action_listener.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport path from 'path';\nimport fs from 'fs';\nimport {\n  HoistUser, Organisation, Application\n}\nfrom '@hoist/model';\nimport logger from '@hoist/logger';\nimport errors from '@hoist/errors';\nimport Bluebird from 'bluebird';\n\nBluebird.promisifyAll(fs);\n\nvar hookFile = path.resolve(__dirname, './hook-include.sh');\n\nclass GitActionListener {\n  constructor() {\n    this._logger = logger.child({\n      cls: this.constructor.name\n    });\n  }\n  bindToRepository(repos) {\n    this._logger.info('binding to repository');\n    repos.on('push', (push) => {\n      return this.push(push);\n    });\n\n  }\n\n  createHookFile(template, target) {\n    this._logger.info('creating hook file');\n    return fs.readFileAsync(template, {\n      encoding: 'utf8'\n    }).then((content) => {\n      content = content.replace('#{dirname}', path.resolve(__dirname));\n      return fs.writeFileAsync(target, content, {\n        mode: '0755'\n      });\n    });\n  }\n\n  push(push) {\n    this._logger.info(\"received git push\");\n\n    return this.processSecurity(push, 'push')\n      .then((gitObject) => {\n        this._logger.info(\"security processed\");\n        let postReceiveHookFile = path.resolve(gitObject.cwd, './hooks/post-receive');\n        fs.unlink(postReceiveHookFile, function () {\n          //throw away error as we don't care\n        });\n        let preRecieveHookFile = path.resolve(gitObject.cwd, './hooks/pre-receive');\n        return this.createHookFile(hookFile, preRecieveHookFile);\n      }).then(() => {\n        push.accept();\n      }).catch((err) => {\n        let errCode = 500;\n        if (err.code) {\n          errCode = parseInt(err.code);\n        }\n        this._logger.error(err);\n        logger.alert(err);\n        push.reject(errCode, err.message);\n      });\n  }\n\n  processSecurity(gitObject, method) {\n    var auth, creds, plainAuth, req;\n    req = gitObject.request;\n    auth = req.headers.authorization;\n    if (!auth) {\n      this._logger.warn(\"no auth header present\");\n      return Promise.reject(new errors.Http401Error('Missing Authentication Header'));\n    } else {\n      this._logger.info({\n        authHeader: auth\n      }, \"processing auth header\");\n      plainAuth = new Buffer(auth.split(' ')[1], 'base64').toString();\n      this._logger.info({\n        plainHeader: plainAuth\n      }, \"processing plain header\");\n      creds = plainAuth.split(':');\n      return this.permissableMethod(creds[0], creds[1], method, gitObject);\n    }\n  }\n\n  permissableMethod(username, password, method, gitObject) {\n    var repoSplit = gitObject.repo.split('/');\n\n    var gitRepo = repoSplit[1];\n    if (gitRepo.length > 4) {\n      gitRepo = gitRepo.indexOf('.git') === gitRepo.length - 4 ? gitRepo.slice(0, -4) : gitRepo;\n    }\n    var gitFolder = repoSplit[0];\n    this._logger.info({\n      gitFolder: gitFolder,\n      gitRepo: gitRepo\n    }, 'git credentials');\n    return this.getUser(username, password)\n      .then((user) => {\n        if (!user) {\n          throw new errors.Http401Error({\n            message: 'Incorrect username or password provided'\n          });\n        }\n        // check if user is in organisation\n        return Organisation.findOneAsync({\n          slug: gitFolder,\n          _id: {\n            $in: user.organisations\n          }\n        });\n      }).then((org) => {\n        if (!org) {\n          this._logger.warn('unable to load organisation');\n          throw new errors.Http401Error(`The specified user doesn't have access to this repository, or the repository doesn't exist`);\n        }\n        this._logger.info({\n          org: org._id\n        }, 'loaded organisation');\n        //check if organisation has application\n\n        return Application.findOneAsync({\n          slug: gitRepo,\n          organisation: org._id\n        });\n      }).then((app) => {\n        if (!app) {\n          this._logger.warn('unable to load application');\n          throw new errors.Http401Error(`The specified user doesn't have access to this repository, or the repository doesn't exist`);\n        }\n        this._logger.info({\n          app: app._id\n        }, 'loaded app');\n        return gitObject;\n      });\n  }\n\n  getUser(username, password) {\n    return HoistUser.findOneAsync({\n      emailAddresses: {\n        $elemMatch: {\n          address: username.toLowerCase()\n        }\n      }\n    }).then((user) => {\n      if (user) {\n        this._logger.info({\n          user: user._id\n        }, 'loaded user');\n      } else {\n        this._logger.warn('no user found');\n      }\n      if (user && user.passwordHash && user.passwordHash.length > 0 && user.verifyPassword(password)) {\n        return user;\n      } else if (user && (!user.passwordHash || user.passwordHash.length < 1)) {\n        this._logger.warn('user doesn\\'t have a password');\n        throw new errors.user.credentials.NoPasswordError();\n      } else {\n        this._logger.warn('user doesnt exist or password wrong');\n        return false;\n      }\n    });\n  }\n\n}\n\n\n\nexport default GitActionListener;\n"
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "hookFile",
    "memberof": "lib/git_action_listener.js",
    "longname": "lib/git_action_listener.js~hookFile",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/git_action_listener.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "class",
    "static": true,
    "variation": null,
    "name": "GitActionListener",
    "memberof": "lib/git_action_listener.js",
    "longname": "lib/git_action_listener.js~GitActionListener",
    "access": null,
    "export": true,
    "importPath": "hoist-git-listener/lib/git_action_listener.js",
    "importStyle": "GitActionListener",
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "interface": false
  },
  {
    "kind": "constructor",
    "static": false,
    "variation": null,
    "name": "constructor",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#constructor",
    "access": null,
    "description": null,
    "lineNumber": 17,
    "undocument": true,
    "params": [],
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "_logger",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#_logger",
    "access": null,
    "description": null,
    "lineNumber": 18,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "bindToRepository",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#bindToRepository",
    "access": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "params": [
      {
        "name": "repos",
        "types": [
          "*"
        ]
      }
    ],
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "createHookFile",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#createHookFile",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "params": [
      {
        "name": "template",
        "types": [
          "*"
        ]
      },
      {
        "name": "target",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "push",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#push",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "params": [
      {
        "name": "push",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "processSecurity",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#processSecurity",
    "access": null,
    "description": null,
    "lineNumber": 67,
    "undocument": true,
    "params": [
      {
        "name": "gitObject",
        "types": [
          "*"
        ]
      },
      {
        "name": "method",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "permissableMethod",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#permissableMethod",
    "access": null,
    "description": null,
    "lineNumber": 87,
    "undocument": true,
    "params": [
      {
        "name": "username",
        "types": [
          "*"
        ]
      },
      {
        "name": "password",
        "types": [
          "*"
        ]
      },
      {
        "name": "method",
        "types": [
          "*"
        ]
      },
      {
        "name": "gitObject",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "getUser",
    "memberof": "lib/git_action_listener.js~GitActionListener",
    "longname": "lib/git_action_listener.js~GitActionListener#getUser",
    "access": null,
    "description": null,
    "lineNumber": 139,
    "undocument": true,
    "params": [
      {
        "name": "username",
        "types": [
          "*"
        ]
      },
      {
        "name": "password",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "gitActionListener",
    "memberof": "lib/git_action_listener.js",
    "longname": "lib/git_action_listener.js~gitActionListener",
    "access": null,
    "export": true,
    "importPath": "hoist-git-listener/lib/git_action_listener.js",
    "importStyle": "gitActionListener",
    "description": null,
    "lineNumber": 170,
    "undocument": true,
    "type": {
      "types": [
        "lib/git_action_listener.js~GitActionListener"
      ]
    }
  },
  {
    "kind": "file",
    "static": true,
    "variation": null,
    "name": "lib/hook.js",
    "memberof": null,
    "longname": "lib/hook.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\n/* jshint multistr:true */\nglobal.Promise = require('bluebird');\nrequire(\"babel/register\");\nvar path = require('path');\nvar configPath = path.resolve(__filename, '../../', 'config');\nprocess.env.NODE_CONFIG_DIR = configPath;\nvar logger = require('@hoist/logger');\nvar Deployer = require('./deployer');\nvar _ = require('lodash');\nvar streamToPromise = require('stream-to-promise');\nlogger.streams = _.reject(logger.streams, function (stream) {\n  return stream.name === 'console';\n});\nstreamToPromise(process.stdin)\n  .then(function (input) {\n    return new Deployer(input);\n  }).then(function (deployer) {\n    return deployer.deploy();\n  }).catch(function (err) {\n    console.log(err.message);\n    process.exit(1);\n  }).finally(function () {\n    process.exit(0);\n  });\n"
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "path",
    "memberof": "lib/hook.js",
    "longname": "lib/hook.js~path",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/hook.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "configPath",
    "memberof": "lib/hook.js",
    "longname": "lib/hook.js~configPath",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/hook.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "logger",
    "memberof": "lib/hook.js",
    "longname": "lib/hook.js~logger",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/hook.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "Deployer",
    "memberof": "lib/hook.js",
    "longname": "lib/hook.js~Deployer",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/hook.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "_",
    "memberof": "lib/hook.js",
    "longname": "lib/hook.js~_",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/hook.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "streamToPromise",
    "memberof": "lib/hook.js",
    "longname": "lib/hook.js~streamToPromise",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/hook.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "file",
    "static": true,
    "variation": null,
    "name": "lib/server.js",
    "memberof": null,
    "longname": "lib/server.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nvar http = require('http');\nvar pushover = require('pushover');\nvar config = require('config');\nvar repos = pushover(config.get('Hoist.filePaths.repositories'), {\n  autoCreate: true\n});\nvar GitActionListener = require('./git_action_listener');\nvar BBPromise = require('bluebird');\nvar mongoose = BBPromise.promisifyAll(require('@hoist/model')._mongoose);\nvar logger = require('@hoist/logger');\nrepos.on('error', function (err) {\n  console.warn(err);\n});\n\nmodule.exports = {\n  createServer: function () {\n    var listener = new GitActionListener();\n    listener.bindToRepository(repos);\n    return BBPromise.promisifyAll(http.createServer(function (req, res) {\n      logger.info(\"got a git request\");\n      if (!req.headers || !req.headers.authorization) {\n        logger.warn(\"no auth header present\");\n        res.setHeader(\"WWW-Authenticate\", 'Basic');\n        res.writeHead(401);\n        res.end(\"invalid username or password\");\n      } else {\n        logger.info('sending to handler');\n        repos.handle(req, res);\n      }\n    }));\n  },\n  start: function (done) {\n    return BBPromise.try(function () {\n        var connected = false;\n        if (mongoose.connection && mongoose.connection.readyState > 0) {\n          connected = true;\n        }\n        return connected;\n      })\n      .bind(this)\n      .then(function (connected) {\n        if (!connected) {\n          return mongoose.connectAsync(config.get('Hoist.mongo.core.connectionString'));\n        } else {\n          return null;\n        }\n      }).then(function () {\n        /* istanbul ignore if */\n        if (this._server) {\n          return BBPromise.resolve(null);\n        }\n        this._server = this.createServer();\n        return this._server.listenAsync(config.get('Hoist.server.port'), config.get('Hoist.server.host'));\n      }).then(function () {\n        logger.info('listening for git actions on port, ' + config.get('Hoist.server.port'));\n      }).nodeify(done);\n  },\n  stop: function (done) {\n    return BBPromise.try(function () {\n      var connected = false;\n      /* istanbul ignore else */\n      if (mongoose.connection && mongoose.connection.readyState > 0 && mongoose.connection.readyState < 3) {\n        connected = true;\n      }\n      return connected;\n    }).bind(this).then(function (connected) {\n      /* istanbul ignore else */\n      if (connected) {\n        return mongoose.disconnectAsync();\n      }\n    }).then(function () {\n      /* istanbul ignore if */\n      if (!this._server) {\n        return BBPromise.resolve(null);\n      }\n      return this._server.closeAsync();\n    }).then(function () {\n      delete this._server;\n    }).nodeify(done);\n  }\n};\n"
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "http",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~http",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 2,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "pushover",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~pushover",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "config",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~config",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "repos",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~repos",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "GitActionListener",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~GitActionListener",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "BBPromise",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~BBPromise",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "mongoose",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~mongoose",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "logger",
    "memberof": "lib/server.js",
    "longname": "lib/server.js~logger",
    "access": null,
    "export": false,
    "importPath": "hoist-git-listener/lib/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Infinity",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~NaN",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~undefined",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~null",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Object",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~object",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Function",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~function",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Boolean",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~boolean",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Symbol",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Error",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~EvalError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~InternalError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~RangeError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~ReferenceError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~SyntaxError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~TypeError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~URIError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Number",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~number",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Date",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~String",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~string",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~RegExp",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int8Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint8Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint8ClampedArray",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int16Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint16Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int32Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint32Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Float32Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Float64Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Map",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Set",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~WeakMap",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~WeakSet",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~ArrayBuffer",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~DataView",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~JSON",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Promise",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Generator",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~GeneratorFunction",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Reflect",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Proxy",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "CanvasRenderingContext2D",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~CanvasRenderingContext2D",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "DocumentFragment",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~DocumentFragment",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Element",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Element",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~Element",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Event",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Event",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~Event",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Node",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Node",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~Node",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "NodeList",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/NodeList",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~NodeList",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "XMLHttpRequest",
    "externalLink": "https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~XMLHttpRequest",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "testFile",
    "static": true,
    "variation": null,
    "name": "tests/unit_tests/deployer_tests.js",
    "memberof": null,
    "longname": "tests/unit_tests/deployer_tests.js",
    "access": null,
    "description": null,
    "lineNumber": 0,
    "content": ""
  },
  {
    "kind": "testFile",
    "static": true,
    "variation": null,
    "name": "tests/unit_tests/git_action_listener_tests.js",
    "memberof": null,
    "longname": "tests/unit_tests/git_action_listener_tests.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport {\n  expect\n}\nfrom 'chai';\nimport sinon from 'sinon';\nimport GitActionListener from '../../lib/git_action_listener';\nimport path from 'path';\nimport fs from 'fs';\nimport {\n  HoistUser, Organisation, Application\n}\nfrom '@hoist/model';\n/** @test {GitActionListener} */\ndescribe('GitActionListener', () => {\n  let gitActionListener;\n  before(() => {\n    gitActionListener = new GitActionListener();\n  });\n  /** @test {GitActionListener#bindToRepository} */\n  describe('GitActionListener#bindToRepository', () => {\n    let stubRepos = {\n      on: sinon.stub()\n    };\n    before(() => {\n      sinon.stub(gitActionListener, 'push');\n      gitActionListener.bindToRepository(stubRepos);\n    });\n    after(() => {\n      gitActionListener.push.restore();\n    });\n    it('binds push event to the #push method', () => {\n      let pushObject = {};\n      return Promise.resolve()\n        .then(() => {\n          stubRepos.on.yield(pushObject);\n        }).then(() => {\n          return expect(gitActionListener.push).to.have.been.calledWith(pushObject);\n        });\n    });\n  });\n  /** @test {GitActionListener#createHookFile} */\n  describe('GitActionListener#createHookFile', () => {\n    let target = 'temp_hook_file';\n    before(() => {\n      let template = path.resolve(__dirname, '../../lib/hook-include.sh');\n      return gitActionListener.createHookFile(template, target);\n    });\n    it('should create link to hook-file', () => {\n      let hookCall = `node \"${path.resolve(__dirname, '../../lib/hook.js')}\"`;\n      return expect(fs.readFileSync(target, 'utf8')).to.contain(hookCall);\n    });\n  });\n  describe('GitActionListener#push', () => {\n    let username = 'test@Hoist.io';\n    let password = 'test';\n    let mockPush = {\n      reject: sinon.stub(),\n      accept: sinon.stub(),\n      cwd: path.resolve(__dirname),\n      repo: \"org/app.git\",\n      request: {\n        headers: {\n          authorization: 'Basic ' + new Buffer(username + \":\" + password, \"utf8\").toString(\"base64\")\n        }\n      }\n    };\n    let organisation;\n    let application;\n    let user;\n    before(() => {\n      organisation = new Organisation({\n        _id: 'org-id',\n        slug: 'org'\n      });\n      application = new Application({\n        organiation: organisation\n      });\n      user = new HoistUser({\n        emailAddresses: [{\n          address: username\n        }],\n        organisations: [organisation._id]\n      });\n\n      sinon.stub(HoistUser, 'findOneAsync').returns(Promise.resolve(user));\n      sinon.stub(Application, 'findOneAsync').returns(Promise.resolve(application));\n      sinon.stub(Organisation, 'findOneAsync').returns(Promise.resolve(organisation));\n      sinon.stub(gitActionListener, 'createHookFile');\n      sinon.stub(fs, 'unlink');\n      return user.setPassword(password);\n    });\n    after(() => {\n      fs.unlink.restore();\n      gitActionListener.createHookFile.restore();\n      Organisation.findOneAsync.restore();\n      Application.findOneAsync.restore();\n      HoistUser.findOneAsync.restore();\n    });\n    describe('if has access to repository', () => {\n\n      before(() => {\n        return gitActionListener.push(mockPush);\n      });\n      after(() => {\n        mockPush.accept.reset();\n      });\n      it('accepts the push', () => {\n        return expect(mockPush.accept).to.have.been.called;\n      });\n      it('queries for lower lower case email addres', () => {\n        return expect(HoistUser.findOneAsync)\n          .to.have.been.calledWith({\n            emailAddresses: {\n              $elemMatch: {\n                address: 'test@hoist.io'\n              }\n            }\n          });\n      });\n      it('queries for organisation user has access to', () => {\n        return expect(Organisation.findOneAsync)\n          .to.have.been.calledWith({\n            slug: 'org',\n            _id: {\n              $in: user.organisations\n            }\n          });\n      });\n      it('queries correct application', () => {\n        return expect(Application.findOneAsync)\n          .to.have.been.calledWith({\n            organisation: 'org-id',\n            slug: 'app'\n          });\n      });\n      it('creates the hook file', () => {\n        return expect(gitActionListener.createHookFile)\n          .to.have.been.calledWith(\n            path.resolve(__dirname, '../../lib/hook-include.sh'),\n            path.resolve(__dirname, './hooks/pre-receive'));\n      });\n    });\n    describe('if push is made without auth header', () => {\n      let originalHeader;\n      before(() => {\n        originalHeader = mockPush.request.headers.authorization;\n        delete mockPush.request.headers.authorization;\n        return gitActionListener.push(mockPush);\n      });\n      after(() => {\n        mockPush.request.headers.authorization = originalHeader;\n        mockPush.reject.reset();\n      });\n      it('rejects the push with a 401 error', () => {\n        return expect(mockPush.reject)\n          .to.have.been.calledWith(401, 'Missing Authentication Header');\n      });\n    });\n    describe('if user doesn\\'t have access to repository', () => {\n      before(() => {\n        Organisation.findOneAsync.returns(Promise.resolve(null));\n        return gitActionListener.push(mockPush);\n      });\n      after(() => {\n        mockPush.reject.reset();\n        Organisation.findOneAsync.returns(Promise.resolve(organisation));\n      });\n      it('rejects the push with a 401 error', () => {\n        return expect(mockPush.reject)\n          .to.have.been.calledWith(401, `The specified user doesn't have access to this repository, or the repository doesn't exist`);\n      });\n    });\n    describe('if username is wrong', () => {\n\n      before(() => {\n        HoistUser.findOneAsync.returns(Promise.resolve(null));\n        return gitActionListener.push(mockPush);\n      });\n      after(() => {\n        HoistUser.findOneAsync.returns(Promise.resolve(user));\n        mockPush.reject.reset();\n      });\n      it('rejects the push with a 401 error', () => {\n        return expect(mockPush.reject)\n          .to.have.been.calledWith(401, `Incorrect username or password provided`);\n      });\n    });\n    describe('if password is wrong', () => {\n      let originalHeader;\n      before(() => {\n        originalHeader = mockPush.request.headers.authorization;\n        mockPush.request.headers.authorization = 'Basic ' + new Buffer(username + \":\" + 'bad-password', \"utf8\").toString(\"base64\");\n        return gitActionListener.push(mockPush);\n      });\n      after(() => {\n        mockPush.request.headers.authorization = originalHeader;\n        mockPush.reject.reset();\n      });\n      it('rejects the push with a 401 error', () => {\n        return expect(mockPush.reject)\n          .to.have.been.calledWith(401, `Incorrect username or password provided`);\n      });\n    });\n  });\n});\n"
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe0",
    "testId": 0,
    "memberof": "tests/unit_tests/git_action_listener_tests.js",
    "testDepth": 0,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0",
    "access": null,
    "description": "GitActionListener",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@test",
        "tagValue": "{GitActionListener}"
      }
    ],
    "testTargets": [
      "GitActionListener"
    ]
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe1",
    "testId": 1,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0",
    "testDepth": 1,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe1",
    "access": null,
    "description": "GitActionListener#bindToRepository",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@test",
        "tagValue": "{GitActionListener#bindToRepository}"
      }
    ],
    "testTargets": [
      "GitActionListener#bindToRepository"
    ]
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it2",
    "testId": 2,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe1",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe1.it2",
    "access": null,
    "description": "binds push event to the #push method",
    "lineNumber": 32
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe3",
    "testId": 3,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0",
    "testDepth": 1,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe3",
    "access": null,
    "description": "GitActionListener#createHookFile",
    "lineNumber": 43,
    "unknown": [
      {
        "tagName": "@test",
        "tagValue": "{GitActionListener#createHookFile}"
      }
    ],
    "testTargets": [
      "GitActionListener#createHookFile"
    ]
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it4",
    "testId": 4,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe3",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe3.it4",
    "access": null,
    "description": "should create link to hook-file",
    "lineNumber": 49
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe5",
    "testId": 5,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0",
    "testDepth": 1,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5",
    "access": null,
    "description": "GitActionListener#push",
    "lineNumber": 54
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe6",
    "testId": 6,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6",
    "access": null,
    "description": "if has access to repository",
    "lineNumber": 100
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it7",
    "testId": 7,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6.it7",
    "access": null,
    "description": "accepts the push",
    "lineNumber": 108
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it8",
    "testId": 8,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6.it8",
    "access": null,
    "description": "queries for lower lower case email addres",
    "lineNumber": 111
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it9",
    "testId": 9,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6.it9",
    "access": null,
    "description": "queries for organisation user has access to",
    "lineNumber": 121
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it10",
    "testId": 10,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6.it10",
    "access": null,
    "description": "queries correct application",
    "lineNumber": 130
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it11",
    "testId": 11,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe6.it11",
    "access": null,
    "description": "creates the hook file",
    "lineNumber": 137
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe12",
    "testId": 12,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe12",
    "access": null,
    "description": "if push is made without auth header",
    "lineNumber": 144
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it13",
    "testId": 13,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe12",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe12.it13",
    "access": null,
    "description": "rejects the push with a 401 error",
    "lineNumber": 155
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe14",
    "testId": 14,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe14",
    "access": null,
    "description": "if user doesn't have access to repository",
    "lineNumber": 160
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it15",
    "testId": 15,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe14",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe14.it15",
    "access": null,
    "description": "rejects the push with a 401 error",
    "lineNumber": 169
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe16",
    "testId": 16,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe16",
    "access": null,
    "description": "if username is wrong",
    "lineNumber": 174
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it17",
    "testId": 17,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe16",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe16.it17",
    "access": null,
    "description": "rejects the push with a 401 error",
    "lineNumber": 184
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe18",
    "testId": 18,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5",
    "testDepth": 2,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe18",
    "access": null,
    "description": "if password is wrong",
    "lineNumber": 189
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it19",
    "testId": 19,
    "memberof": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe18",
    "testDepth": 3,
    "longname": "tests/unit_tests/git_action_listener_tests.js~describe0.describe5.describe18.it19",
    "access": null,
    "description": "rejects the push with a 401 error",
    "lineNumber": 200
  },
  {
    "kind": "testFile",
    "static": true,
    "variation": null,
    "name": "tests/unit_tests/server_tests.js",
    "memberof": null,
    "longname": "tests/unit_tests/server_tests.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nrequire('../bootstrap');\nvar sinon = require('sinon');\nvar expect = require('chai').expect;\nvar http = require('http');\nvar BBPromise = require('bluebird');\nvar GitActionListener = require('../../lib/git_action_listener');\nvar mongoose = require('@hoist/model')._mongoose;\nvar hoistServer = require('../../lib/server');\n\ndescribe('server', function () {\n  describe('#stop', function () {\n    describe('with active mongo connection', function () {\n      var server = {\n        close: sinon.stub().callsArg(0)\n      };\n      var _originalConnections;\n      before(function (done) {\n        sinon.stub(mongoose, 'disconnect').callsArg(0);\n        _originalConnections = mongoose.connections;\n        mongoose.connections = [];\n        mongoose.connections.push({\n          readyState: 1\n        });\n        hoistServer._server = BBPromise.promisifyAll(server);\n        hoistServer.stop(done);\n      });\n      after(function () {\n        delete hoistServer._server;\n        mongoose.connections = _originalConnections;\n      });\n      it('disconnects mongo', function () {\n        /* jshint -W030 */\n        return expect(mongoose.disconnect)\n          .to.have.been.called;\n      });\n    });\n  });\n  describe('#start', function () {\n    describe('with active connection', function () {\n      var server = {\n        listen: sinon.stub().callsArg(2)\n      };\n      var _repos;\n      var _originalConnections;\n      before(function (done) {\n        sinon.stub(GitActionListener.prototype, 'bindToRepository', function (repos) {\n          _repos = repos;\n          sinon.stub(_repos, 'handle');\n        });\n        sinon.stub(mongoose, 'connect').callsArg(1);\n        sinon.stub(http, 'createServer').returns(server);\n        _originalConnections = mongoose.connections;\n        mongoose.connections = [];\n        mongoose.connections.push({\n          readyState: 1\n        });\n        hoistServer.start(done);\n      });\n      after(function () {\n        delete hoistServer._server;\n        http.createServer.restore();\n        mongoose.connect.restore();\n        mongoose.connections = _originalConnections;\n        GitActionListener.prototype.bindToRepository.restore();\n        _repos.handle.restore();\n      });\n      it('doesn\\'t reconnect to mongo', function () {\n        /*jshint -W030 */\n        return expect(mongoose.connect)\n          .to.have\n          .not.been.called;\n      });\n      it('creates a server', function () {\n        /* jshint -W030 */\n        return expect(http.createServer)\n          .to.have.been.called;\n      });\n      it('listens', function () {\n        /* jshint -W030 */\n        return expect(server.listen)\n          .to.have.been.called;\n      });\n      it('binds to repository', function () {\n        /* jshint -W030 */\n        return expect(GitActionListener.prototype.bindToRepository)\n          .to.have.been.called;\n      });\n    });\n    describe('with no active connection', function () {\n      var server = {\n        listen: sinon.stub().callsArg(2)\n      };\n      var _repos;\n      before(function (done) {\n        sinon.stub(GitActionListener.prototype, 'bindToRepository', function (repos) {\n          _repos = repos;\n          sinon.stub(_repos, 'handle');\n        });\n        sinon.stub(mongoose, 'connect').callsArg(1);\n        sinon.stub(http, 'createServer').returns(server);\n        hoistServer.start(done);\n      });\n      after(function () {\n        delete hoistServer._server;\n        http.createServer.restore();\n        mongoose.connect.restore();\n        GitActionListener.prototype.bindToRepository.restore();\n        _repos.handle.restore();\n      });\n      it('connects to mongo', function () {\n        expect(mongoose.connect)\n          .to.have.been.calledWith('mongodb://db/hoist-default');\n      });\n      it('creates a server', function () {\n        /* jshint -W030 */\n        return expect(http.createServer)\n          .to.have.been.called;\n      });\n      it('listens', function () {\n        /* jshint -W030 */\n        return expect(server.listen)\n          .to.have.been.called;\n      });\n      it('binds to repository', function () {\n        /* jshint -W030 */\n        return expect(GitActionListener.prototype.bindToRepository)\n          .to.have.been.called;\n      });\n      describe('on request', function () {\n        var req = {\n          headers: {\n            authorization: 'auth'\n          }\n        };\n        var res = {};\n        before(function () {\n          http.createServer.callArgWith(0, req, res);\n        });\n        it('passes req and res to repos', function () {\n          expect(_repos.handle)\n            .to.have.been.calledWith(req, res);\n        });\n      });\n    });\n  });\n});\n"
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe20",
    "testId": 20,
    "memberof": "tests/unit_tests/server_tests.js",
    "testDepth": 0,
    "longname": "tests/unit_tests/server_tests.js~describe20",
    "access": null,
    "description": "server",
    "lineNumber": 11
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe21",
    "testId": 21,
    "memberof": "tests/unit_tests/server_tests.js~describe20",
    "testDepth": 1,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe21",
    "access": null,
    "description": "#stop",
    "lineNumber": 12
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe22",
    "testId": 22,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe21",
    "testDepth": 2,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe21.describe22",
    "access": null,
    "description": "with active mongo connection",
    "lineNumber": 13
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it23",
    "testId": 23,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe21.describe22",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe21.describe22.it23",
    "access": null,
    "description": "disconnects mongo",
    "lineNumber": 32
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe24",
    "testId": 24,
    "memberof": "tests/unit_tests/server_tests.js~describe20",
    "testDepth": 1,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24",
    "access": null,
    "description": "#start",
    "lineNumber": 39
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe25",
    "testId": 25,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24",
    "testDepth": 2,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe25",
    "access": null,
    "description": "with active connection",
    "lineNumber": 40
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it26",
    "testId": 26,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe25",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe25.it26",
    "access": null,
    "description": "doesn't reconnect to mongo",
    "lineNumber": 68
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it27",
    "testId": 27,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe25",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe25.it27",
    "access": null,
    "description": "creates a server",
    "lineNumber": 74
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it28",
    "testId": 28,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe25",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe25.it28",
    "access": null,
    "description": "listens",
    "lineNumber": 79
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it29",
    "testId": 29,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe25",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe25.it29",
    "access": null,
    "description": "binds to repository",
    "lineNumber": 84
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe30",
    "testId": 30,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24",
    "testDepth": 2,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30",
    "access": null,
    "description": "with no active connection",
    "lineNumber": 90
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it31",
    "testId": 31,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe30",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.it31",
    "access": null,
    "description": "connects to mongo",
    "lineNumber": 111
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it32",
    "testId": 32,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe30",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.it32",
    "access": null,
    "description": "creates a server",
    "lineNumber": 115
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it33",
    "testId": 33,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe30",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.it33",
    "access": null,
    "description": "listens",
    "lineNumber": 120
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it34",
    "testId": 34,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe30",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.it34",
    "access": null,
    "description": "binds to repository",
    "lineNumber": 125
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe35",
    "testId": 35,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe30",
    "testDepth": 3,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.describe35",
    "access": null,
    "description": "on request",
    "lineNumber": 130
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it36",
    "testId": 36,
    "memberof": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.describe35",
    "testDepth": 4,
    "longname": "tests/unit_tests/server_tests.js~describe20.describe24.describe30.describe35.it36",
    "access": null,
    "description": "passes req and res to repos",
    "lineNumber": 140
  }
]